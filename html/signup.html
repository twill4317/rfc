<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]>      <html class="no-js"> <!--<![endif]-->
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>RFC SignUp</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="/css/style.css">
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="#">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->
        <div id="stytch-sdk"></div>
        <header>
            <div id="headerTopTrim">
               
            </div>
            <div id="topNavBar">
                <a href="/html/home.html"><img src="/repo/rfc_logo_no_white.png" id="logo"/></a>
                <h4 id="topNavRFC">R F C</h4>
                <!-- <h5>RFC</h5> -->
                <!-- <ul class="nav-links">
                    <li>
                        <a href="/html/home.html">Home</a>
                    </li>
                    <li>
                        <a href="">Library</a>
                    </li>
                    <li>
                        <a href="">Network</a>
                    </li>
                    <li>
                        <a href="">Resources</a>
                    </li>
                    <li>
                        <a href="">Programming</a>
                    </li>
                </ul> -->
            </div>

           
        </header>
        <content class="event-container">
            <div class="form-frame">
                <div class="form-title">
                    <h1>Sign Up!</h1>
                </div>
                <input type="text" id="user-name" name="name" placeholder="Email . . ."/>
                <input type="text" id="pass-word" name="pass" placeholder="Password . . ."/>
                <button class="sign-up-button">Sign Up !</button>

            </div>
        </content>
        <footer>

        </footer>
        <script src="https://js.stytch.com/stytch.js" id="js-stytch" async defer>
             var STYTCH_PUBLIC_TOKEN = "public-token-test-6e43514a-c82e-472e-b297-b6ee012f1d51";

var style = {
    fontFamily: ' "Helvetica New", Hevletica , sans-serif',
    primaryColor: '#106ee9',
    primaryTextColor: '#090909',
};

var loginOrSignupView = {
    products: ['emailMagicLinks'],
    emailMagicLinksOptions: {
        loginRedirectURL: "http://127.0.0.1:5500/html/login.html",
        loginExpirationMinutes: 30,
        signupRedirectURL: "http://127.0.0.1:5500/html/signup.html",
        signupExpirationMinutes: 30,
    }
}

var stytch = Stytch(STYTCH_PUBLIC_TOKEN, {
    onEvent: async(response) => {
        const userExists = false;
        if(response.data.type === 'USER_EVENT_TYPE' && !userExists){
            try {
                await fetch('/users', {
                    method: 'POST',
                    mode:'cors',
                    body:JSON.stringify({ userId: response.data.userID}),
                    headers: {
                        'Content-Type': 'application/json'
                    },
                });
            } catch(e) {
                    console.log(e)
                }
            }
        },
        onSuccess: (response) => {
            console.log(e);
        },
        onError: (response) => {
            console.log(response)
        }               
    });

    stytch.mount({
        elementId: "#stytch-sdk",
        style: style,
        loginOrSignupView: loginOrSignupView
    });
    
    app.post('/users', function(req,res){
        var stytchUserId = req.body.userId;
        res.send('Created user with stytchUserId: ${stytchUserId}')
    })
        </script>    
    </body>
</html>